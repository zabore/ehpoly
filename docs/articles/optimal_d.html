<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial: Identify the optimal D subtype solution • riskclustr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial: Identify the optimal D subtype solution">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">riskclustr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calculate_d.html">Estimate the extent of etiologic heterogeneity</a>
    </li>
    <li>
      <a href="../articles/eh_test.html">Test for etiologic heterogeneity</a>
    </li>
    <li>
      <a href="../articles/optimal_d.html">Identify the optimal D subtype solution</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/zabore/riskclustr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Tutorial: Identify the optimal D subtype solution</h1>
                        <h4 class="author">Emily C. Zabor</h4>
            
            <h4 class="date">Last updated: January 18, 2019</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/zabore/riskclustr/blob/master/vignettes/optimal_d.Rmd"><code>vignettes/optimal_d.Rmd</code></a></small>
      <div class="hidden name"><code>optimal_d.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Sometimes subtypes will not be pre-defined, but rather it will be of interest to identify subtypes that differ maximally with respect to risk heterogeneity based on some number of disease markers.</p>
<p>This tutorial will introduce you to the <code><a href="../reference/optimal_kmeans_d.html">optimal_kmeans_d()</a></code> function, which will run <span class="math inline">\(k\)</span>-means clustering, using the <code><a href="https://www.rdocumentation.org/packages/stats/topics/kmeans">kmeans()</a></code> function, on disease marker data and identify the subtype solution that maximizes <span class="math inline">\(D\)</span>. When <span class="math inline">\(k\)</span>-means clustering is run with multiple random starts, it will return a variety of class solutions, as the algorithm typically reaches a local rather than global maxima. Then for each candidate class solution, <span class="math inline">\(D\)</span> can be computed and the solution that maximizes <span class="math inline">\(D\)</span>, a measure of etiologic heterogeneity, can be identified. This function is currently for use with case-control data only. See <a href="calculate_d.html">Tutorial: Estimate the extent of etiologic heterogeneity</a> for details on the calculation of the <span class="math inline">\(D\)</span> value.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This tutorial will make use of a simulated example dataset named <code>subtype_data</code>. This simulated dataset contains 1200 case subjects and 800 control subjects. There are 30 continuous disease markers available on the cases. There are two continuous risk factors and one binary risk factor available on all subjects.</p>
<p>Say for example that interest was in identifying the optimally etiologically heterogeneous 3-subtype solution based on all 30 markers <code>y1</code>-<code>y30</code> available in <code>subtype_data</code>, using all three risk factors <code>x1</code>, <code>x2</code> and <code>x3</code>. We use the default of 100 random starts of the <span class="math inline">\(k\)</span>-means clustering algorithm, and set a seed so that results would be reproduced if we were to run this code again on a later date. Note that this function is currently a bit slow to run due to the fitting of numerous models, so please be patient.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(riskclustr)</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3">res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/optimal_kmeans_d.html">optimal_kmeans_d</a></span>(</a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="dt">markers =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"y"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>))),</a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="dt">M =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1-6" title="6">  <span class="dt">factors =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>),</a>
<a class="sourceLine" id="cb1-7" title="7">  <span class="dt">case =</span> <span class="st">"case"</span>,</a>
<a class="sourceLine" id="cb1-8" title="8">  <span class="dt">data =</span> subtype_data,</a>
<a class="sourceLine" id="cb1-9" title="9">  <span class="dt">nstart =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="dt">seed =</span> <span class="dv">81110224</span>)</a></code></pre></div>
<p>The function returns a list with one element for the optimal <span class="math inline">\(D\)</span> value and one element that is the original data frame with a column added for the optimal <span class="math inline">\(D\)</span> class solution.</p>
<p>First let’s look at a tabulation of <code>optimal_d_label</code> from the <code>optimal_d_data</code> object to see how each case was classified into a subtype:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/table">table</a></span>(res[[<span class="st">"optimal_d_data"</span>]]<span class="op">$</span>optimal_d_label)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt;   0   1   2   3 </span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt; 800 300 599 301</span></a></code></pre></div>
<p>These subtype labels could now be used as the outcome in a polytomous logistic regression model fit with <code><a href="../reference/eh_test_subtype.html">eh_test_subtype()</a></code> to obtain measures of risk factor association as well as heterogeneity <span class="math inline">\(p\)</span>-values. See <a href="eh_test.html">Tutorial: test for etiologic heterogeneity in a case-control study</a> for details.</p>
<p>Next we can see the <span class="math inline">\(D\)</span> value that goes long with the optimal subtype solution:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">res[[<span class="st">"optimal_d"</span>]]</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt; [1] 0.3385876</span></a></code></pre></div>
<p>We see that this optimal 3-subtype solution based on clustering the 30 disease markers results in <span class="math inline">\(D=0.339\)</span>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#example">Example</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Emily C. Zabor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
