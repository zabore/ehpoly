<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Conduct an analysis of etiologic heterogeneity for pre-defined subtypes
using polytomous logistic regression — plrsub • riskclustr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Conduct an analysis of etiologic heterogeneity for pre-defined subtypes
using polytomous logistic regression — plrsub" />

<meta property="og:description" content="plrsub takes a vector of class labels for pre-specified
subtypes and a list of risk factors and returns results related to the
question of whether each risk factor differs across levels of the disease
subtypes
Input is a dataframe that contains the risk factors of interest and a
variable containing numeric class labels that is 0 for control subjects.
Risk factors can be either binary or continuous. For categorical risk
factors, a reference level should be selected and then indicator variables
for each remaining level of the risk factor should be created.
Categorical risk factors entered as is will be treated as ordinal.
Class labels for the cases can be specified as a vector. The multinomial
logistic regression model is fit using the mlogit function from the
mlogit package." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">riskclustr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Conduct an analysis of etiologic heterogeneity for pre-defined subtypes
using polytomous logistic regression</h1>
    
    <div class="hidden name"><code>plrsub.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>plrsub</code> takes a vector of class labels for pre-specified
subtypes and a list of risk factors and returns results related to the
question of whether each risk factor differs across levels of the disease
subtypes</p>
<p>Input is a dataframe that contains the risk factors of interest and a
variable containing numeric class labels that is 0 for control subjects.
Risk factors can be either binary or continuous. For categorical risk
factors, a reference level should be selected and then indicator variables
for each remaining level of the risk factor should be created.
Categorical risk factors entered as is will be treated as ordinal.
Class labels for the cases can be specified as a vector. The multinomial
logistic regression model is fit using the <code>mlogit</code> function from the
<code>mlogit</code> package.</p>
    
    </div>

    <pre class="usage"><span class='fu'>plrsub</span>(<span class='no'>cls</span>, <span class='no'>m</span>, <span class='no'>rf</span>, <span class='no'>data</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cls</th>
      <td><p>the name of the variable in the data that contains numeric class
labels. This should be 0 for all controls. Argument must be supplied in
quotes.</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>is the number of subtypes</p></td>
    </tr>
    <tr>
      <th>rf</th>
      <td><p>a list of the names of the binary or continuous risk factors.
For binary risk factors the lowest level will be used as the reference level.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>the name of the dataframe that contains the tumor markers and risk
factors.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list.</p>
<p><code>beta</code> is a matrix containing the estimated beta parameters with a
column for each risk factor and a row for each disease subtype.</p>
<p><code>beta_se</code> contains the associated standard errors.</p>
<p><code>eh_pval</code> is a vector of p-values for testing whether each risk factor
differs across levels of the disease subtype.</p>
<p><code>or_ci_p</code> is a dataframe with a odds ratio (95<!-- % CI) for each risk -->
factor/subtype combination, as well as a column of etiologic heterogeneity
p-values.</p>
<p><code>beta_se_p</code> is a dataframe with the estimated beta parameters (SE) for
each risk factor/subtype combination, as well as a column of
etiologic heterogeneity p-values.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># generate the data - 4 classes and 2 risk factors</span>
<span class='no'>class</span> <span class='kw'>&lt;-</span> <span class='fu'>rep</span>(<span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>), <span class='kw'>times</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1000</span>, <span class='fl'>250</span>, <span class='fl'>250</span>, <span class='fl'>250</span>, <span class='fl'>250</span>))
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='fl'>2000</span> * <span class='fl'>2</span>), <span class='fl'>2000</span>, <span class='fl'>2</span>) +
<span class='fu'>model.matrix</span>(~<span class='fu'>factor</span>(<span class='no'>class</span>))[, -<span class='fl'>1</span>] <span class='kw'>%*%</span>
<span class='fu'>t</span>(<span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1.5</span>, <span class='fl'>0</span>, <span class='fl'>0.75</span>, <span class='fl'>0.25</span>, <span class='fl'>0.25</span>, <span class='fl'>0.75</span>, <span class='fl'>0</span>, <span class='fl'>1.5</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>4</span>))
<span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>class</span> <span class='kw'>=</span> <span class='no'>class</span>, <span class='kw'>x1</span> <span class='kw'>=</span> <span class='no'>x</span>[, <span class='fl'>1</span>], <span class='kw'>x2</span> <span class='kw'>=</span> <span class='no'>x</span>[, <span class='fl'>2</span>])

<span class='fu'>plrsub</span>(<span class='st'>"class"</span>, <span class='fl'>4</span>, <span class='fu'>c</span>(<span class='st'>"x1"</span>, <span class='st'>"x2"</span>), <span class='no'>df</span>)</div><div class='output co'>#&gt; $beta
#&gt;              1         2         3           4
#&gt; x1  1.43823236 0.6217025 0.2603424 -0.07037174
#&gt; x2 -0.09650237 0.1628955 0.7529632  1.67731150
#&gt; 
#&gt; $beta_se
#&gt;             1          2          3          4
#&gt; x1 0.09077930 0.07468161 0.07387586 0.08403158
#&gt; x2 0.08098555 0.07362975 0.07649468 0.09752521
#&gt; 
#&gt; $eh_pval
#&gt; P P 
#&gt; 0 0 
#&gt; 
#&gt; $or_ci_p
#&gt;                     1                  2                  3                  4
#&gt; x1 4.21 (3.53 - 5.03) 1.86 (1.61 - 2.16)   1.3 (1.12 - 1.5)  0.93 (0.79 - 1.1)
#&gt; x2 0.91 (0.77 - 1.06) 1.18 (1.02 - 1.36) 2.12 (1.83 - 2.47) 5.35 (4.42 - 6.48)
#&gt;    p_het
#&gt; x1 &lt;.001
#&gt; x2 &lt;.001
#&gt; 
#&gt; $beta_se_p
#&gt;              1           2           3            4 p_het
#&gt; x1 1.44 (0.09) 0.62 (0.07) 0.26 (0.07) -0.07 (0.08) &lt;.001
#&gt; x2 -0.1 (0.08) 0.16 (0.07) 0.75 (0.08)   1.68 (0.1) &lt;.001
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Emily C Zabor <a href='mailto:zabore@mskcc.org'>zabore@mskcc.org</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Emily C. Zabor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

