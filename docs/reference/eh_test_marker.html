<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Test for etiologic heterogeneity of risk factors according to individual
disease markers in a case-control study — eh_test_marker • riskclustr</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Test for etiologic heterogeneity of risk factors according to individual
disease markers in a case-control study — eh_test_marker" />

<meta property="og:description" content="eh_test_marker takes a list of individual disease markers
and a list of risk factors and returns results related to the question of
whether each risk factor differs across levels of the disease subtypes and
the question of whether each risk factor differs across levels of each
individual tumor marker of which the disease subtypes are comprised.
Input is a dataframe that contains the individual disease markers, the risk
factors of interest, and an indicator of case or control status.
The tumor markers must be binary and must have levels
0 or 1 for cases. The tumor markers should be left missing for control
subjects. For categorical tumor markers, a reference level should be selected
and then indicator variables for each remaining level of the tumor marker
should be created. Risk factors can be either binary or continuous. For
categorical risk factors, a reference level should be selected and then
indicator variables for each remaining level of the risk factor should be
created." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">riskclustr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/calculate_d.html">Estimate the extent of etiologic heterogeneity</a>
    </li>
    <li>
      <a href="../articles/eh_test.html">Test for etiologic heterogeneity</a>
    </li>
    <li>
      <a href="../articles/optimal_d.html">Identify the optimal D solution</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/zabore/riskclustr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Test for etiologic heterogeneity of risk factors according to individual
disease markers in a case-control study</h1>
    <small class="dont-index">Source: <a href='https://github.com/zabore/riskclustr/blob/master/R/eh_test_marker.R'><code>R/eh_test_marker.R</code></a></small>
    <div class="hidden name"><code>eh_test_marker.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>eh_test_marker</code> takes a list of individual disease markers
and a list of risk factors and returns results related to the question of
whether each risk factor differs across levels of the disease subtypes and
the question of whether each risk factor differs across levels of each
individual tumor marker of which the disease subtypes are comprised.</p>
<p>Input is a dataframe that contains the individual disease markers, the risk
factors of interest, and an indicator of case or control status.
The tumor markers must be binary and must have levels
0 or 1 for cases. The tumor markers should be left missing for control
subjects. For categorical tumor markers, a reference level should be selected
and then indicator variables for each remaining level of the tumor marker
should be created. Risk factors can be either binary or continuous. For
categorical risk factors, a reference level should be selected and then
indicator variables for each remaining level of the risk factor should be
created.</p>
    
    </div>

    <pre class="usage"><span class='fu'>eh_test_marker</span>(<span class='no'>markers</span>, <span class='no'>factors</span>, <span class='no'>case</span>, <span class='no'>data</span>, <span class='kw'>digits</span> <span class='kw'>=</span> <span class='fl'>2</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>markers</th>
      <td><p>a list of the names of the binary disease markers.
Each must have levels 0 or 1 for case subjects. This value will be missing
for all control subjects. e.g. <code>markers = list("marker1", "marker2")</code></p></td>
    </tr>
    <tr>
      <th>factors</th>
      <td><p>a list of the names of the binary or continuous risk factors.
For binary risk factors the lowest level will be used as the reference level.
e.g. <code>factors = list("age", "sex", "race")</code></p></td>
    </tr>
    <tr>
      <th>case</th>
      <td><p>denotes the variable that contains each subject's status as a
case or control. This value should be 1 for cases and 0 for controls.
Argument must be supplied in quotes, e.g. <code>case = "status"</code>.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>the name of the dataframe that contains the relevant variables.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>the number of digits to round the odds ratios and associated
confidence intervals, and the estimates and associated standard errors.
Defaults to 2.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list.</p>
<p><code>beta</code> is a matrix containing the raw estimates from the
polytomous logistic regression model fit with <code><a href='https://www.rdocumentation.org/packages/mlogit/topics/mlogit'>mlogit</a></code>
with a row for each risk factor and a column for each disease subtype.</p>
<p><code>beta_se</code> is a matrix containing the raw standard errors from the
polytomous logistic regression model fit with <code><a href='https://www.rdocumentation.org/packages/mlogit/topics/mlogit'>mlogit</a></code>
with a row for each risk factor and a column for each disease subtype.</p>
<p><code>eh_pval</code> is a vector of unformatted p-values for testing whether each
risk factor differs across the levels of the disease subtype.</p>
<p><code>gamma</code> is a matrix containing the estimated disease marker parameters,
obtained as linear combinations of the <code><a href='https://www.rdocumentation.org/packages/base/topics/Special'>beta</a></code> estimates,
with a row for each risk factor and a column for each tumor marker.</p>
<p><code>gamma_se</code> is a matrix containing the estimated disease marker
standard errors, obtained based on a transformation of the <code><a href='https://www.rdocumentation.org/packages/base/topics/Special'>beta</a></code>
standard errors, with a row for each risk factor and a column for each
tumor marker.</p>
<p><code>gamma_p</code> is a matrix of p-values for testing whether each risk factor
differs across levels of each tumor marker, with a row for each risk
factor and a column for each tumor marker.</p>
<p><code>or_ci_p</code> is a dataframe with the odds ratio (95<!-- % CI) for each risk -->
factor/subtype combination, as well as a column of formatted etiologic
heterogeneity p-values.</p>
<p><code>beta_se_p</code> is a dataframe with the estimates (SE) for
each risk factor/subtype combination, as well as a column of formatted
etiologic heterogeneity p-values.</p>
<p><code>gamma_se_p</code> is a dataframe with disease marker estimates (SE) and
their associated p-values.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Run for two binary tumor markers, which will combine to form four subtypes</span>
<span class='fu'>eh_test_marker</span>(
    <span class='kw'>markers</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='st'>"marker1"</span>, <span class='st'>"marker2"</span>),
    <span class='kw'>factors</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='st'>"x1"</span>, <span class='st'>"x2"</span>, <span class='st'>"x3"</span>),
    <span class='kw'>case</span> <span class='kw'>=</span> <span class='st'>"case"</span>,
    <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>subtype_data</span>,
    <span class='kw'>digits</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='output co'>#&gt; $beta
#&gt;            1         2         3         4
#&gt; x1 1.5555082 0.2410591 0.8232515 0.1086845
#&gt; x2 0.3031594 0.3518870 0.4335048 0.3714092
#&gt; x3 0.8000998 3.0115985 1.9909315 1.5594139
#&gt; 
#&gt; $beta_se
#&gt;             1          2          3          4
#&gt; x1 0.08753299 0.07586862 0.07493534 0.06932731
#&gt; x2 0.07838983 0.07596005 0.07322825 0.06978524
#&gt; x3 0.22460699 0.17831011 0.18331057 0.18231380
#&gt; 
#&gt; $eh_pval
#&gt;        x1        x2        x3 
#&gt; 0.0000000 0.4778092 0.0000000 
#&gt; 
#&gt; $gamma
#&gt;         marker1     marker2
#&gt; x1 -1.014508074 -0.43231568
#&gt; x2 -0.006684034  0.07493381
#&gt; x3  0.889990475 -0.13067645
#&gt; 
#&gt; $gamma_se
#&gt;       marker1    marker2
#&gt; x1 0.06810255 0.06018029
#&gt; x2 0.06314648 0.05884233
#&gt; x3 0.14506060 0.13484794
#&gt; 
#&gt; $gamma_pval
#&gt;         marker1      marker2
#&gt; x1 0.000000e+00 6.785683e-13
#&gt; x2 9.157016e-01 2.028521e-01
#&gt; x3 8.499803e-10 3.325126e-01
#&gt; 
#&gt; $or_ci_p
#&gt;                    1                   2                3                4
#&gt; x1  4.74 (3.99-5.62)    1.35 (1.16-1.58) 2.23 (1.43-3.46)  1.27 (1.1-1.48)
#&gt; x2  1.42 (1.23-1.65) 20.32 (14.33-28.82) 2.28 (1.97-2.64) 1.54 (1.34-1.78)
#&gt; x3 7.32 (5.11-10.49)    1.11 (0.97-1.28) 1.45 (1.26-1.66)  4.76 (3.33-6.8)
#&gt;    p_het
#&gt; x1 &lt;.001
#&gt; x2 0.478
#&gt; x3 &lt;.001
#&gt; 
#&gt; $beta_se_p
#&gt;              1           2           3           4 p_het
#&gt; x1 1.56 (0.09)  0.3 (0.08)  0.8 (0.22) 0.24 (0.08) &lt;.001
#&gt; x2 0.35 (0.08) 3.01 (0.18) 0.82 (0.07) 0.43 (0.07) 0.478
#&gt; x3 1.99 (0.18) 0.11 (0.07) 0.37 (0.07) 1.56 (0.18) &lt;.001
#&gt; 
#&gt; $gamma_se_p
#&gt;     marker1 est marker1 pval  marker2 est marker2 pval
#&gt; x1 -1.01 (0.07)        &lt;.001 -0.43 (0.06)        &lt;.001
#&gt; x2 -0.01 (0.06)        0.916  0.07 (0.06)        0.203
#&gt; x3  0.89 (0.15)        &lt;.001 -0.13 (0.13)        0.333
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Emily C Zabor <a href='mailto:zabore@mskcc.org'>zabore@mskcc.org</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Emily C. Zabor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

