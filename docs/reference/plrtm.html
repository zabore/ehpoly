<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Conduct an analysis of etiologic heterogeneity for individual tumor markers
using polytomous logistic regression — plrtm • riskclustr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Conduct an analysis of etiologic heterogeneity for individual tumor markers
using polytomous logistic regression — plrtm" />

<meta property="og:description" content="plrtm takes a list of individual tumor markers and a
list of risk factors and returns results related to the question of whether
each risk factor differs across levels of the disease subtypes and the
question of whether each risk factor differs across levels of each individual
tumor marker of which the disease subtypes are comprised.
Input is a dataframe that contains the individual tumor markers, the risk
factors of interest, and an indicator of case or control status.
The tumor markers must be binary and must have levels
0 or 1 for cases. The tumor markers should be left missing for control
subjects. For categorical tumor markers, a reference level should be selected
and then indicator variables for each remaining level of the tumor marker
should be created. For continuous tumor markers, categories should be formed
and then indicator variables can be constructed as in the case of categorical
tumor markers. Risk factors can be either binary or continuous. For
categorical risk factors, a reference level should be selected and then
indicator variables for each remaining level of the risk factor should be
created. Categorical risk factors entered as is will be treated as ordinal." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">riskclustr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Conduct an analysis of etiologic heterogeneity for individual tumor markers
using polytomous logistic regression</h1>
    
    <div class="hidden name"><code>plrtm.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>plrtm</code> takes a list of individual tumor markers and a
list of risk factors and returns results related to the question of whether
each risk factor differs across levels of the disease subtypes and the
question of whether each risk factor differs across levels of each individual
tumor marker of which the disease subtypes are comprised.</p>
<p>Input is a dataframe that contains the individual tumor markers, the risk
factors of interest, and an indicator of case or control status.
The tumor markers must be binary and must have levels
0 or 1 for cases. The tumor markers should be left missing for control
subjects. For categorical tumor markers, a reference level should be selected
and then indicator variables for each remaining level of the tumor marker
should be created. For continuous tumor markers, categories should be formed
and then indicator variables can be constructed as in the case of categorical
tumor markers. Risk factors can be either binary or continuous. For
categorical risk factors, a reference level should be selected and then
indicator variables for each remaining level of the risk factor should be
created. Categorical risk factors entered as is will be treated as ordinal.</p>
    
    </div>

    <pre class="usage"><span class='fu'>plrtm</span>(<span class='no'>tm</span>, <span class='no'>rf</span>, <span class='no'>case</span>, <span class='no'>data</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tm</th>
      <td><p>a list of the names of the binary tumor markers.
Each must have levels 0 or 1 for case subjects. This value will be missing
for all control subjects.</p></td>
    </tr>
    <tr>
      <th>rf</th>
      <td><p>a list of the names of the binary or continuous risk factors.
For binary risk factors the lowest level will be used as the reference level.</p></td>
    </tr>
    <tr>
      <th>case</th>
      <td><p>denotes the variable that contains each subject's status as a
case or control. This value should be 1 for cases and 0 for controls.
Argument must be supplied in quotes.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>the name of the dataframe that contains the tumor markers and risk
factors.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list.</p>
<p><code>beta</code> is a matrix containing the estimated beta parameters with a
column for each risk factor and a row for each disease subtype.</p>
<p><code>beta_se</code> contains the associated standard errors.</p>
<p><code>eh_pval</code> is a vector of p-values for testing whether each risk factor
differs across levels of the disease subtype.</p>
<p><code>gamma</code> is a matrix containing the estimated gamma parameters,
obtained as linear combinations of the beta parameters with a column for each
risk factor and a row for each tumor marker.</p>
<p><code>gamma_se</code> contains the associated standard errors.</p>
<p><code>gamma_p</code> is a matrix of p-values for testing whether each risk factor
differs across levels of each tumor marker, with a column for each risk
factor and a row for each tumor marker.</p>
<p><code>or_ci_p</code> is a dataframe with a odds ratio (95<!-- % CI) for each risk -->
factor/subtype combination, as well as a column of etiologic heterogeneity
p-values.</p>
<p><code>beta_se_p</code> is a dataframe with the estimated beta parameters (SE) for
each risk factor/subtype combination, as well as a column of
etiologic heterogeneity p-values.</p>
<p><code>gamma_se_p</code> is a dataframe with estimates of the gamma tumor marker
effects (SE) and their associated p-values.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># generate the data - 2 tumor markers and 2 risk factors</span>
<span class='no'>class</span> <span class='kw'>&lt;-</span> <span class='fu'>rep</span>(<span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>), <span class='kw'>times</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1000</span>, <span class='fl'>250</span>, <span class='fl'>250</span>, <span class='fl'>250</span>, <span class='fl'>250</span>))
<span class='no'>tm1</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fu'>rep</span>(<span class='fl'>0</span>, <span class='fl'>1000</span>), <span class='fu'>rep</span>(<span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>), <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>250</span>))
<span class='no'>tm2</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fu'>rep</span>(<span class='fl'>0</span>, <span class='fl'>1000</span>), <span class='fu'>rep</span>(<span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>), <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>500</span>))
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='fl'>2000</span> * <span class='fl'>2</span>), <span class='fl'>2000</span>, <span class='fl'>2</span>) +
<span class='fu'>model.matrix</span>(~<span class='fu'>factor</span>(<span class='no'>class</span>))[, -<span class='fl'>1</span>] <span class='kw'>%*%</span>
<span class='fu'>t</span>(<span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1.5</span>, <span class='fl'>0</span>, <span class='fl'>0.75</span>, <span class='fl'>0.25</span>, <span class='fl'>0.25</span>, <span class='fl'>0.75</span>, <span class='fl'>0</span>, <span class='fl'>1.5</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>4</span>))
<span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>class</span> <span class='kw'>=</span> <span class='no'>class</span>, <span class='kw'>x1</span> <span class='kw'>=</span> <span class='no'>x</span>[, <span class='fl'>1</span>], <span class='kw'>x2</span> <span class='kw'>=</span> <span class='no'>x</span>[, <span class='fl'>2</span>], <span class='kw'>tm1</span> <span class='kw'>=</span> <span class='no'>tm1</span>, <span class='kw'>tm2</span> <span class='kw'>=</span> <span class='no'>tm2</span>)
<span class='no'>df</span>$<span class='no'>caseind</span> <span class='kw'>&lt;-</span> <span class='fu'>ifelse</span>(<span class='no'>df</span>$<span class='no'>class</span> <span class='kw'>==</span> <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>)

<span class='fu'>plrtm</span>(<span class='fu'>c</span>(<span class='st'>"tm1"</span>, <span class='st'>"tm2"</span>), <span class='fu'>c</span>(<span class='st'>"x1"</span>, <span class='st'>"x2"</span>), <span class='st'>"caseind"</span>, <span class='no'>df</span>)</div><div class='output co'>#&gt; $beta
#&gt;             x1          x2
#&gt; 0/0  1.4029759 -0.04665709
#&gt; 1/0  0.7740862  0.11992210
#&gt; 0/1  0.3323620  0.69854733
#&gt; 1/1 -0.0239302  1.41208034
#&gt; 
#&gt; $beta_se
#&gt;             x1         x2
#&gt; 0/0 0.08839810 0.08061884
#&gt; 1/0 0.07620564 0.07422797
#&gt; 0/1 0.07488919 0.07539221
#&gt; 1/1 0.08205529 0.08831054
#&gt; 
#&gt; $eh_pval
#&gt; P P 
#&gt; 0 0 
#&gt; 
#&gt; $gamma
#&gt;           tm1        tm2
#&gt; x1 -0.4925910 -0.9343151
#&gt; x2  0.4400561  1.0186813
#&gt; 
#&gt; $gamma_se
#&gt;           tm1       tm2
#&gt; x1 0.06835020 0.0766922
#&gt; x2 0.06746024 0.0768419
#&gt; 
#&gt; $gamma_pval
#&gt;            tm1 tm2
#&gt; x1 5.72542e-13   0
#&gt; x2 6.88265e-11   0
#&gt; 
#&gt; $or_ci_p
#&gt;                   0/0                1/0                0/1                1/1
#&gt; x1 4.07 (3.42 - 4.84) 2.17 (1.87 - 2.52)  1.39 (1.2 - 1.61) 0.98 (0.83 - 1.15)
#&gt; x2 0.95 (0.81 - 1.12)  1.13 (0.97 - 1.3) 2.01 (1.73 - 2.33)  4.1 (3.45 - 4.88)
#&gt;    p_het
#&gt; x1 &lt;.001
#&gt; x2 &lt;.001
#&gt; 
#&gt; $beta_se_p
#&gt;             0/0         1/0         0/1          1/1 p_het
#&gt; x1   1.4 (0.09) 0.77 (0.08) 0.33 (0.07) -0.02 (0.08) &lt;.001
#&gt; x2 -0.05 (0.08) 0.12 (0.07)  0.7 (0.08)  1.41 (0.09) &lt;.001
#&gt; 
#&gt; $gamma_se_p
#&gt;         tm1 est tm1 pval      tm2 est tm2 pval
#&gt; x1 -0.49 (0.07)    &lt;.001 -0.93 (0.08)    &lt;.001
#&gt; x2  0.44 (0.07)    &lt;.001  1.02 (0.08)    &lt;.001
#&gt; </div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Emily C Zabor <a href='mailto:zabore@mskcc.org'>zabore@mskcc.org</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Emily C. Zabor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

